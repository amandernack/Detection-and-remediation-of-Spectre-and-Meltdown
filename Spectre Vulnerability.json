{
  "policy": {
    "name": "Spectre Vulnerability",
    "description": "",
    "module": "csm",
    "platform": "windows",
    "template": false,
    "shared": true,
    "retired": false,
    "read_only": false,

    "rules": [
      {
        "active": true,
        "alert": false,
        "comment": "",
        "critical": true,
        "rule_operator": "AND",
        "log": true,
        "name": "Vulnerable to Spectre",
        "taxonomy": "system_configuration",
        "checks": [
          {
            "object_type": "registry_key_value_setting",
            "active": true,
            "exportable": true,
            "suggestion": "If GenuineIntel is found, then you are vulnerable.\r\n\r\nPlease follow the Windows Server guidance to protect against speculative execution side-channel vulnerabilities.\r\n\r\nFound here:\r\nhttps://support.microsoft.com/en-us/help/4072698/windows-server-guidance-to-protect-against-the-speculative-execution",
            "registry_key": "HKEY_LOCAL_MACHINE\\Hardware\\Description\\System\\CentralProcessor\\0",
            "value_name": "VendorIdentifier",
            "expected_data": "NOT: GenuineIntel"
          }
        ],
        "reference_identifiers": []
      },
      {
        "active": true,
        "alert": false,
        "comment": "This rule checks to see if the Spectre fix has been put in place.",
        "critical": true,
        "rule_operator": "AND",
        "log": true,
        "name": "Spectre Fix",
        "taxonomy": "system_configuration",
        "checks": [
          {
            "object_type": "registry_key_value_setting",
            "active": true,
            "exportable": true,
            "suggestion": "If this check fails, the the Spectre check has not been put in place, or is not configured correctly. Please follow the Windows Server guidance to protect against speculative execution side-channel vulnerabilities.\r\n\r\nFound here:\r\nhttps://support.microsoft.com/en-us/help/4072698/windows-server-guidance-to-protect-against-the-speculative-execution",
            "registry_key": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management",
            "value_name": "FeatureSettingsOverride",
            "expected_data": "0"
          },
          {
            "object_type": "registry_key_value_setting",
            "active": true,
            "exportable": true,
            "suggestion": "If this check fails, the the Spectre check has not been put in place, or is not configured correctly. Please follow the Windows Server guidance to protect against speculative execution side-channel vulnerabilities.\r\n\r\nFound here:\r\nhttps://support.microsoft.com/en-us/help/4072698/windows-server-guidance-to-protect-against-the-speculative-execution",
            "registry_key": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management",
            "value_name": "FeatureSettingsOverrideMask",
            "expected_data": "3"
          }
        ],
        "reference_identifiers": []
      }
    ]
  }
}
